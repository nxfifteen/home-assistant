---
alias: gitlab_ci_failure
trigger:
  platform: state
  entity_id:
  - sensor.gitlab_ci_hass
  - sensor.gitlab_ci_store
  - sensor.gitlab_ci_nxore_sync
  to: 'failed'
  
action:
  - service: notify.synchat_nx
    data_template:
      message: "GitLab validation testing failed for on {{ trigger.to_state.attributes.friendly_name }}. #GitLab #CI #Failed"
  - service: notify.alexa_media
    data:
      target: 
        - media_player.study
      data:
        type: announce
      message: "GitLab validation testing failed for {{ trigger.to_state.attributes.friendly_name }}."