---
alias: family_stuart_car_park

trigger:
- platform: mqtt
  topic: tracker/family/stuart/phone/location
  
condition:
- condition: template
  value_template: '{{ trigger.payload_json[''ignition''] == ''false'' }}'
- condition: template
  value_template: '{{ trigger.payload_json.lat is defined }}'
- condition: template
  value_template: '{{ trigger.payload_json.lon is defined }}'
  
action:
  - service: notify.synchat_hab
    data_template:
      message: "Your cars location has been updated. #AI #Debug"
      
  - service: device_tracker.see
    data_template:
      dev_id: stuart_car
      gps:
      - '{{ trigger.payload_json.lat }}'
      - '{{ trigger.payload_json.lon }}'
      gps_accuracy: 1
      host_name: "Stuart's Car"
      mac: '00:25:42:73:A1:B9'
      source_type: gps
