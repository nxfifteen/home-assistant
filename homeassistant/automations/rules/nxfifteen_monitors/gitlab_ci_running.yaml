---
alias: GitLab CI Running
trigger:
  - platform: state
    entity_id: sensor.gitlab_252_ci
    to: 'running'

  - platform: state
    entity_id: sensor.gitlab_274_ci
    to: 'running'

  - platform: state
    entity_id: sensor.gitlab_279_ci
    to: 'running'
  
condition:
  - condition: state
    entity_id: sensor.family_stuart_state
    state: '7'
  
action:
  - service: light.turn_on
    data:
      entity_id: light.ff_study_wall
      effect: colorloop
      brightness: 255
      transition: 3
      
  - service: light.turn_on
    data:
      entity_id: light.ff_study_desk
      effect: colorloop
      brightness: 77
      transition: 3

  - service: notify.synchat_nx
    data_template:
      message: "GitLab validation testing is running. #GitLab #CI"

  - service: notify.alexa_media
    data:
      target: 
        - media_player.study
      data:
        type: announce
      message: "Git Lab is running continuous Integration testing now."