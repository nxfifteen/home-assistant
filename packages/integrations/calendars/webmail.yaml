---
calendar:
  - platform: caldav
    username: !secret webmail_username
    password: !secret webmail_password
    url: !secret webmail_cal_main

  - platform: caldav
    username: !secret webmail_username
    password: !secret webmail_password
    url: !secret webmail_cal_main
    custom_calendars:
      - name: 'Bin Trash'
        calendar: 'Reminders'
        search: 'Blue & Brown Bins This Week'
      - name: 'Bin Green'
        calendar: 'Reminders'
        search: 'Green Bins This Week'
      - name: 'Bin Grey'
        calendar: 'Reminders'
        search: 'Grey Bins This Week'
      - name: 'Bin Out'
        calendar: 'Reminders'
        search: 'Bin Needs to Go Out'
      - name: 'Bin Day'
        calendar: 'Reminders'
        search: 'Its Bin Day'

sensor:
  - platform: template
    sensors:
      this_weeks_bin:
        friendly_name: 'This Weeks Bin'
        value_template: >
          {% if is_state("calendar.reminders_bin_green", "on") -%}
            Green
          {%- elif is_state("calendar.reminders_bin_grey", "on") -%}
            Grey
          {%- else -%}
            Blue & Brown
          {%- endif %}