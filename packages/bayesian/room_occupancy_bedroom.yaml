---
binary_sensor:
  name: room_occupancy_bedroom
  platform: 'bayesian'
  prior: 0.12 # 0.12 -> 100 / 7 rooms
  probability_threshold: 0.95
  observations:
    # we are in the study -> very likely at least one household member is at home, and we're not asleep
    - platform: 'numeric_state'
      entity_id: 'sensor.family_family_state_raw'
      prob_given_true: 1 # 99% chance that if we are in the study we are at home
      prob_given_false: 0.05 # 30% chance that if we are not in the study when we are at home
      above: 4
    # we are in the study -> very likely at least one household member is at home, and we're not asleep
    - platform: 'state'
      entity_id: 'sensor.house_scene'
      prob_given_true: 1 # 99% chance that if we are in the study we are at home
      prob_given_false: 0.40 # 30% chance that if we are not in the study when we are at home
      to_state: Asleep
    # we are in the study -> very likely at least one household member is at home, and we're not asleep
    - platform: 'state'
      entity_id: 'sensor.house_scene'
      prob_given_true: 1 # 99% chance that if we are in the study we are at home
      prob_given_false: 0.50 # 30% chance that if we are not in the study when we are at home
      to_state: Going To Bed
    # we are in the study -> very likely motion is detected
    - entity_id: binary_sensor.motion_ff_bedroom
      platform: state
      to_state: 'on'
      prob_given_true: 1 # 90% chance that if we are in the study if motion is detected
      prob_given_false: 0.80 # 10% chance that if we are in the study if no motion is detected
    # we are in the study -> likely if the monitors are on
    - platform: 'state'
      entity_id: 'switch.ff_bedroom_tv'
      prob_given_true: 0.99  # 70% chance that if we are in the study if the monitors are on
      prob_given_false: 0.80 # 10% chance that if we are in the study if the monitors are off
      to_state: 'on'
    - platform: 'state'
      entity_id: 'sensor.media_ff_bedroom_alexa'
      prob_given_true: 1  # 70% chance that if we are in the study if media is playing
      prob_given_false: 0.80 # 50% chance that if we are in the study if media is not playing
      to_state: 'playing'
    - platform: 'state'
      entity_id: 'sensor.media_ff_bedroom_fire_tv'
      prob_given_true: 1  # 70% chance that if we are in the study if media is playing
      prob_given_false: 0.80 # 50% chance that if we are in the study if media is not playing
      to_state: 'playing'
    - platform: 'state'
      entity_id: 'sensor.media_ff_bedroom_plex_audio'
      prob_given_true: 0.99  # 70% chance that if we are in the study if media is playing
      prob_given_false: 0.50 # 50% chance that if we are in the study if media is not playing
      to_state: 'playing'

homeassistant:
  customize:
    binary_sensor.room_occupancy_bedroom:
      friendly_name: Bedroom Occupancy
      icon_template: mdi:account-search-outline
      device_class: motion